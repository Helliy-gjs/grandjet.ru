var loginChecker=function(){var i="";var j=0;var n=0;var c=0;var a=0;var g=0;function h(o){if(n==2){n=3;g--;d(o)}else{n=0}}function m(o){if(n==2){g--}clearTimeout(o);n=0}function l(){c=0;a=0}function e(o){m(j);l();setStat(o,-1)}function f(o){m(j);if(a==1){return}a=1;c=0;setStat(o,0,"Минимум 4 символа.")}function b(o){m(j);if(c==1){return}c=1;a=0;setStat(o,0,"Недопустимые символы в логине.")}function k(o){var q=document.getElementById("login");if(--g!=0||c==1||a==1||q.value.length==0){return}var p=o.documentElement.getElementsByTagName("ans")[0];p=p.firstChild.nodeValue;if(p==1){setStat(q,0,"Такой логин уже используется.")}else{setStat(q,1)}}function d(o){var q=o.value;if(q==i&&n!=3){return false}i=q;if(q.length==0){e(o);return true}if(new RegExp("^[A-Za-z]{1}[A-Za-z0-9]*$").test(q)){if(q.length<4){f(o);return true}else{switch(n){case 3:case 0:setStat(o,2,"Проверка...");g++;n=1;l();var p=makePostRequest("/ajax/checkLogin.php","login="+q);p.addCallback(k);j=setTimeout(function(r){return function(){loginChecker.afterTimeOut(r)}}(o),1000);break;case 1:g++;n=2;break}}}else{b(o)}return true}return{check:d,afterTimeOut:h}}();var passChecker=function(){var h="";var j="";var m=0;var l=0;var q=0;var p=0;var i;var n=new Array("qwerty","123456","1234567","asdfgh","zxcvbn");function k(){m=0;q=0;p=0}function c(r){k();setStat(r,-1)}function g(r){if(q==1){return}q=1;m=0;p=0;setStat(r,0,"Минимум 6 символов.")}function e(r){if(m==1){return}m=1;q=0;p=0;setStat(r,0,"Недопустимые символы в пароле.")}function f(r){if(p==1){return}p=1;m=0;q=0;setStat(r,0,"Слишком простой пароль.")}function a(u){i=new Array();var t;for(var r=0;r<u.length&&i.length<4;r++){t=true;for(var s=0;s<i.length;s++){if(i[s]==u.charCodeAt(r)){t=false;break}}if(t){i.push(u.charCodeAt(r))}}}function o(s){for(var r=0;r<n.length;r++){if(s==n[r]){return true}}return false}function b(r){var s=r.value;if(s==h){return false}h=s;if(s.length==0){c(r);return true}if(new RegExp("^[A-Za-z0-9`~!@#$%^&*\\-_=+\\\\|'\";:/?.,><]*$").test(s)){if(s.length<6){g(r);return true}a(s);if(i.length<4||o(s.toLowerCase())){f(r);return true}k();setStat(r,1);j="";d(document.getElementById("passr"))}else{e(r)}return true}function d(r){var s=r.value;if(s==j){return false}j=s;if(s.length==0){l=0;setStat(r,-1);return true}if(s!=document.getElementById("pass").value){if(l==1){return false}l=1;setStat(r,0,"Пароли не совпадают")}else{l=0;setStat(r,1)}return true}return{check:b,checkr:d}}();var emailChecker=function(){var e="";var m="";var i=null;var n=0;var f=0;var d=0;var g=0;function h(p){if(n==2){n=3;g--;b(p)}else{n=0}}function l(p){if(n==2){g--}clearTimeout(p);n=0}function k(){f=0}function a(p){l(i);k();setStat(p,-1)}function o(p){l(i);if(f==1){return}f=1;setStat(p,0,"Неверный адрес.")}function j(p){var s=document.getElementById("email");if(--g!=0||f==1||s.value.length==0){return}var q=p.documentElement.getElementsByTagName("ans")[0];q=q.firstChild.nodeValue;if(q==1){setStat(s,0,"Такой e-mail уже зарегистрирован.")}else{setStat(s,1)}}function b(p){var r=p.value;if(r==e&&n!=3){return false}e=r;if(r.length==0){a(p);return true}if(new RegExp("^[a-z0-9.\\-_]+@[a-z0-9.\\-_]+\\.[a-z]{2,4}$","i").test(r)){switch(n){case 3:case 0:setStat(p,2,"Проверка...");g++;n=1;k();var q=makePostRequest("/ajax/checkEmail.php","email="+r);q.addCallback(j);i=setTimeout(function(s){return function(){emailChecker.afterTimeOut(s)}}(p),1000);m="";c(document.getElementById("emailr"));break;case 1:g++;n=2;break}}else{o(p)}return true}function c(p){var q=p.value;if(q==m){return false}m=q;if(q.length==0){d=0;setStat(p,-1);return true}if(q!=document.getElementById("email").value){if(d==1){return false}d=1;setStat(p,0,"Адреса не совпадают")}else{d=0;setStat(p,1)}return true}return{check:b,checkr:c,afterTimeOut:h}}();function toggleKey(c){c=c||window.event;var b=c.target||c.srcElement;if(b.tagName!="INPUT"){return}var a;switch(b.name){case"login":a=ButtonStat.getStat(0);if(a==1){ButtonStat.changeStat(0,0)}if(!loginChecker.check(b)&&a==1){ButtonStat.changeStat(1,0)}break;case"pass":a=ButtonStat.getStat(1);if(a==1){ButtonStat.changeStat(0,1)}if(!passChecker.check(b)&&a==1){ButtonStat.changeStat(1,1)}break;case"passr":a=ButtonStat.getStat(2);if(a==1){ButtonStat.changeStat(0,2)}if(!passChecker.checkr(b)&&a==1){ButtonStat.changeStat(1,2)}break;case"email":a=ButtonStat.getStat(3);if(a==1){ButtonStat.changeStat(0,3)}if(!emailChecker.check(b)&&a==1){ButtonStat.changeStat(1,3)}break;case"emailr":a=ButtonStat.getStat(4);if(a==1){ButtonStat.changeStat(0,4)}if(!emailChecker.checkr(b)&&a==1){ButtonStat.changeStat(1,4)}break}}function setStat(e,d,b){var a=null;var c=null;if(e.nextSibling!=null&&e.nextSibling.tagName=="SPAN"){c=e.nextSibling}var f;switch(e.name){case"login":f=0;break;case"pass":f=1;break;case"passr":f=2;break;case"email":f=3;break;case"emailr":f=4;break}switch(d){case -1:e.style.borderColor="#BCC0FF";if(c!=null){e.parentNode.removeChild(c)}break;case 1:e.style.borderColor="#57B060";if(c==null){c=document.createElement("SPAN");e.parentNode.appendChild(c)}c.className="ok";if(c.firstChild!=null){c.firstChild.nodeValue="\u00A0"}else{c.appendChild(document.createTextNode("\u00A0"))}ButtonStat.changeStat(1,f);break;case 0:e.style.borderColor="#FF6262";if(c==null){c=document.createElement("SPAN");e.parentNode.appendChild(c)}c.className="error";if(c.firstChild!=null){c.firstChild.nodeValue=b}else{c.appendChild(document.createTextNode(b))}break;case 2:e.style.borderColor="#BCC0FF";if(c==null){c=document.createElement("SPAN");e.parentNode.appendChild(c)}c.className="loading";if(c.firstChild!=null){c.firstChild.nodeValue=b}else{c.appendChild(document.createTextNode(b))}break}}var ButtonStat=function(){var d=0;var e=0;var c=new Array(0,0,0,0,0);function b(){d=0;for(var f=0;f<c.length;f++){d+=c[f]}}function g(f){return c[f]}function a(f,h){if(c[h]!=f){c[h]=f;b();if(d==5&&e==0){e=1;document.getElementById("regBut").removeAttribute("disabled")}if(d!=5&&e==1){e=0;document.getElementById("regBut").setAttribute("disabled","disabled")}}}return{changeStat:a,getStat:g}}();function checkAll(){loginChecker.check(document.getElementById("login"));emailChecker.check(document.getElementById("email"));emailChecker.checkr(document.getElementById("emailr"))};